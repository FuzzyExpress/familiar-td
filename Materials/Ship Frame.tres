[gd_resource type="ShaderMaterial" load_steps=6 format=3 uid="uid://davv5tla1cpxd"]

[sub_resource type="Shader" id="Shader_eb4t5"]
code = "// NOTE: Shader automatically converted from Godot Engine 4.5.1.stable's StandardMaterial3D.

shader_type spatial;
render_mode blend_mix, depth_draw_opaque, cull_back, diffuse_burley, specular_schlick_ggx;

uniform vec4 albedo : source_color;

uniform float roughness : hint_range(0.0, 1.0);

uniform float specular : hint_range(0.0, 1.0, 0.01);
uniform float metallic : hint_range(0.0, 1.0, 0.01);

uniform float dmg_fac : hint_range(0., 1.) = 1;

uniform sampler2D nTexture;
uniform sampler2D normTexture;


#include \"res://Shaders/fBM Noise.gdshaderinc\"
#include \"res://Shaders/Remap.gdshaderinc\"

#define DIFFUSE_BURLEY
#define SPECULAR_SCHLICK_GGX
#include \"res://Shaders/standard_lighting.gdshaderinc\"

//void vertex() {
	//UV = UV * uv1_scale.xy + uv1_offset.xy;
//}

void light()
{
	STANDARD_LIGHTING(DIFFUSE_LIGHT, SPECULAR_LIGHT);
}

void fragment() {
	vec2 iUV = - UV + vec2(1.);

	ALBEDO = albedo.rgb;
	
	float noise = texture(nTexture, UV).r;
	float noise2 = texture(nTexture, iUV).r;
	
	float dmg = remap(0.0, 1, 1, 0, noise);
	float swt = float(dmg > dmg_fac);
	ALBEDO = mix(albedo.rgb, vec3(.4), swt );

	METALLIC = metallic;
	SPECULAR = specular;
	

	vec4 roughness_texture_channel = vec4(1.0, 0.0, 0.0, 0.0);
	ROUGHNESS = mix(roughness, mix(0.4, 0.7, dmg), float(dmg > dmg_fac) );
	//NORMAL = mix(NORMAL, NORMAL + texture(normTexture, iUV).rgb, swt);
	//ALBEDO = NORMAL;
	

}
"

[sub_resource type="FastNoiseLite" id="FastNoiseLite_eb4t5"]
noise_type = 0
seed = 80

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_etqa6"]
noise = SubResource("FastNoiseLite_eb4t5")

[sub_resource type="FastNoiseLite" id="FastNoiseLite_etqa6"]
noise_type = 0
frequency = 0.02

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_888xi"]
noise = SubResource("FastNoiseLite_etqa6")

[resource]
resource_local_to_scene = true
render_priority = 0
shader = SubResource("Shader_eb4t5")
shader_parameter/albedo = Color(0, 0.612604, 0.29661313, 1)
shader_parameter/roughness = 0.70000003325
shader_parameter/specular = 0.0
shader_parameter/metallic = 1.0
shader_parameter/dmg_fac = 1.0
shader_parameter/nTexture = SubResource("NoiseTexture2D_etqa6")
shader_parameter/normTexture = SubResource("NoiseTexture2D_888xi")
